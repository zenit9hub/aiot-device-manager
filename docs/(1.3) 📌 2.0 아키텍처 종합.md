# 2.0 ì•„í‚¤í…ì²˜

## ğŸ¯ Executive Summary: 5ë¶„ ì•„í‚¤í…ì²˜ ì´í•´

### í•µì‹¬ ì² í•™

**"ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ë¡œ ë°±ì—”ë“œ ë¶€ë‹´ ìµœì†Œí™” â†’ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì— ì§‘ì¤‘"**

Firebaseì™€ AWSì˜ ë§¤ë‹ˆì§€ë“œ ì„œë¹„ìŠ¤ë¥¼ ì „ëµì ìœ¼ë¡œ ì¡°í•©í•˜ì—¬, ë³µì¡í•œ ì¸í”„ë¼ ìš´ì˜ ì—†ì´ í”„ë¡ íŠ¸ì—”ë“œ ì¤‘ì‹¬ ê°œë°œì— ì§‘ì¤‘í•©ë‹ˆë‹¤. ì¸ì¦Â·ì‹¤ì‹œê°„ DBÂ·í˜¸ìŠ¤íŒ…ì„ í´ë¼ìš°ë“œ ì œê³µìì—ê²Œ ìœ„ì„í•˜ê³ , í•„ìš”ì‹œ ì»¤ìŠ¤í…€ ë°±ì—”ë“œë¥¼ ì ì§„ì ìœ¼ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” í•˜ì´ë¸Œë¦¬ë“œ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤.

### 3ë‹¨ê³„ ì§„í™” ë¡œë“œë§µ

```
Phase 1 (1ì£¼)          Phase 2 (2ì£¼)              Phase 3 (ë¯¸ë˜)
Firebase Only    â†’    Hybrid Architecture   â†’   Microservices
   MVP                  Enterpriseê¸‰              ëŒ€ê·œëª¨ í™•ì¥
```

**Phase 1**: ì„œë²„ ì—†ì´ Firebaseë§Œìœ¼ë¡œ ì™„ì „í•œ IoT ê´€ë¦¬ í”Œë«í¼ êµ¬ì¶•  
**Phase 2**: Express ë°±ì—”ë“œ ì¶”ê°€ë¡œ ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬  
**Phase 3**: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë¶„ë¦¬ ë° Kubernetes ë°°í¬

### ê¸°ìˆ  ìŠ¤íƒ ì„ íƒ ì´ìœ  (í•œ ì¤„ ìš”ì•½)

- **Firebase Auth**: ì¸ì¦ ì„œë²„ êµ¬ì¶• ë¶ˆí•„ìš”, OAuth ì¦‰ì‹œ ì‚¬ìš©
- **Firestore**: ì‹¤ì‹œê°„ ë™ê¸°í™” ìë™ ì œê³µ, ì„œë²„ì‚¬ì´ë“œ ì½”ë“œ ë¶ˆí•„ìš”
- **AWS Amplify**: Git pushë§Œìœ¼ë¡œ ìë™ ë¹Œë“œÂ·ë°°í¬ ì™„ë£Œ
- **Vite + Tailwind**: ë¹ ë¥¸ ê°œë°œ ì„œë²„ì™€ ì¼ê´€ëœ ìŠ¤íƒ€ì¼ ì²´ê³„
- **Express + MySQL** (Phase 2): ë³µì¡í•œ ì¿¼ë¦¬ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬

### ì´ ë¬¸ì„œì˜ êµ¬ì„±

|ì„¹ì…˜|ë‚´ìš©|ì†Œìš” ì‹œê°„|
|---|---|---|
|[í•™ìŠµ ê²½ë¡œ ê°€ì´ë“œ](https://claude.ai/chat/9d72cef5-ae00-4592-8b03-994f3ac16dbc#-%ED%95%99%EC%8A%B5-%EA%B2%BD%EB%A1%9C-%EC%84%A0%ED%83%9D-%EA%B0%80%EC%9D%B4%EB%93%9C)|ì‹œê°„ë³„ ë§ì¶¤ í•™ìŠµ ê²½ë¡œ|5ë¶„|
|[ì•„í‚¤í…ì²˜ ê°œìš”](https://claude.ai/chat/9d72cef5-ae00-4592-8b03-994f3ac16dbc#-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98-%EA%B0%9C%EC%9A%94)|ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¡°|15ë¶„|
|[ê¸°ìˆ  ìŠ¤íƒ](https://claude.ai/chat/9d72cef5-ae00-4592-8b03-994f3ac16dbc#-%EA%B8%B0%EC%88%A0-%EC%8A%A4%ED%83%9D)|ì„ íƒ ê¸°ìˆ ê³¼ ì´ìœ |10ë¶„|
|[í”Œë«í¼ ë””ìì¸](https://claude.ai/chat/9d72cef5-ae00-4592-8b03-994f3ac16dbc#-%ED%94%8C%EB%9E%AB%ED%8F%BC-%EB%94%94%EC%9E%90%EC%9D%B8)|ìƒì„¸ ë‹¤ì´ì–´ê·¸ë¨|20ë¶„|
|[API ëª…ì„¸ì„œ](https://claude.ai/chat/9d72cef5-ae00-4592-8b03-994f3ac16dbc#-api-%EB%AA%85%EC%84%B8%EC%84%9C)|ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ|30ë¶„|
|[í™˜ê²½ êµ¬ì„± ê°€ì´ë“œ](https://claude.ai/chat/9d72cef5-ae00-4592-8b03-994f3ac16dbc#-%ED%99%98%EA%B2%BD-%EA%B5%AC%EC%84%B1-%EA%B0%80%EC%9D%B4%EB%93%9C)|ì‹¤ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸|60ë¶„|
|[ë°°í¬Â·ìš´ì˜](https://claude.ai/chat/9d72cef5-ae00-4592-8b03-994f3ac16dbc#-%EB%B0%B0%ED%8F%AC%EC%9A%B4%EC%98%81-%EA%B0%80%EC%9D%B4%EB%93%9C)|Amplify ë°°í¬|30ë¶„|
|[íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](https://claude.ai/chat/9d72cef5-ae00-4592-8b03-994f3ac16dbc#-%ED%8A%B8%EB%9F%AC%EB%B8%94%EC%8A%88%ED%8C%85-%EA%B0%80%EC%9D%B4%EB%93%9C)|ë¬¸ì œ í•´ê²°|ì°¸ê³ ìš©|

---

## ğŸ“ í•™ìŠµ ê²½ë¡œ ì„ íƒ ê°€ì´ë“œ

### ğŸš€ ë¹ ë¥¸ ì‹œì‘ (2ì‹œê°„ ê³¼ì •)

**ëŒ€ìƒ**: ì´ˆë³´ì ë˜ëŠ” ì‹œê°„ì´ ì œí•œì ì¸ ê²½ìš°

**í•™ìŠµ ìˆœì„œ**:

1. Executive Summary ì½ê¸° (5ë¶„)
2. Phase 1 ì²´í¬ë¦¬ìŠ¤íŠ¸ ë”°ë¼í•˜ê¸° (90ë¶„)
3. ë¡œì»¬ì—ì„œ ë””ë°”ì´ìŠ¤ CRUD ë™ì‘ í™•ì¸ (25ë¶„)

**ê±´ë„ˆë›¸ ìˆ˜ ìˆëŠ” ì„¹ì…˜**:

- Phase 2 ë°±ì—”ë“œ ì„¤ì •
- ì„±ëŠ¥ ë° í’ˆì§ˆ ì„¤ê³„
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í™•ì¥ ì‹œë‚˜ë¦¬ì˜¤

**í•™ìŠµ ëª©í‘œ**:

- âœ… Firebaseë¡œ ë¹ ë¥´ê²Œ MVP êµ¬ì¶•í•˜ëŠ” ê²½í—˜
- âœ… ì‹¤ì‹œê°„ ë™ê¸°í™”ì˜ ì‘ë™ ì›ë¦¬ ì´í•´
- âœ… ì„œë²„ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ì˜ ì¥ì  ì²´ë“

---

### ğŸ¯ ì™„ì „í•œ ì´í•´ (8ì‹œê°„ ê³¼ì •)

**ëŒ€ìƒ**: ì•„í‚¤í…ì²˜ ì„¤ê³„ ì—­ëŸ‰ì„ ê°–ì¶”ê³  ì‹¶ì€ ê²½ìš°

**í•™ìŠµ ìˆœì„œ**:

1. ì „ì²´ ë¬¸ì„œ ì •ë… (2ì‹œê°„)
2. Phase 1 êµ¬í˜„ (2ì‹œê°„)
3. Phase 2 êµ¬í˜„ (3ì‹œê°„)
4. ë³´ì•ˆ ê·œì¹™ ì»¤ìŠ¤í„°ë§ˆì´ì§• (1ì‹œê°„)

**í•„ìˆ˜ ì„¹ì…˜**: ëª¨ë“  ì„¹ì…˜

**í•™ìŠµ ëª©í‘œ**:

- âœ… Firebase â†’ Backend í™•ì¥ ê³¼ì • ì´í•´
- âœ… í•˜ì´ë¸Œë¦¬ë“œ ë°ì´í„° ì „ëµ ìˆ˜ë¦½ ëŠ¥ë ¥
- âœ… í”„ë¡œë•ì…˜ ë°°í¬ ë° ìš´ì˜ ì—­ëŸ‰

---

### ì„ ìˆ˜ ì§€ì‹ ì²´í¬

í•™ìŠµ ì „ ë‹¤ìŒ í•­ëª©ì„ í™•ì¸í•˜ì„¸ìš”:

- [ ] JavaScript ê¸°ë³¸ ë¬¸ë²• (ë³€ìˆ˜, í•¨ìˆ˜, Promise)
- [ ] HTML/CSS ê¸°ì´ˆ
- [ ] Git ê¸°ë³¸ ëª…ë ¹ì–´ (clone, commit, push)
- [ ] Firebase ê³„ì • (Google ê³„ì •ìœ¼ë¡œ ì¦‰ì‹œ ìƒì„± ê°€ëŠ¥)

**ì„ ìˆ˜ ì§€ì‹ì´ ë¶€ì¡±í•œ ê²½ìš°**:

- JavaScript: [MDN JavaScript Guide](https://developer.mozilla.org/ko/docs/Web/JavaScript/Guide)
- Git: [Git ì…ë¬¸ ê°€ì´ë“œ](https://git-scm.com/book/ko/v2)

---

## ğŸ“‹ ë¬¸ì œ ì •ì˜

### ìƒí™©

AIoT ì„œë¹„ìŠ¤ í”Œë«í¼ MVP ê°œë°œì´ í•„ìš”í•œ ìƒí™©

### ì œì•½ì‚¬í•­

- ì†Œê·œëª¨ íŒ€ (2-3ëª…)
- ë¹ ë¥¸ ì‹œì¥ ì¶œì‹œ í•„ìš” (1-2ì£¼)
- ë°±ì—”ë“œ ìš´ì˜ ê²½í—˜ ì œí•œì 
- ì œí•œëœ ì˜ˆì‚°

### ëª©í‘œ

ì‚¬ìš©ìê°€ IoT ë””ë°”ì´ìŠ¤ë¥¼ ë“±ë¡Â·ëª¨ë‹ˆí„°ë§Â·ì œì–´í•  ìˆ˜ ìˆëŠ” ì‹¤ì‹œê°„ ì‹œê°í™” í”Œë«í¼ êµ¬ì¶•

### í•µì‹¬ ìš”êµ¬ì‚¬í•­

**ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­**:

- ì‚¬ìš©ì ì¸ì¦ (Email/Password, Google OAuth)
- ì‹¤ì‹œê°„ ë””ë°”ì´ìŠ¤ ìƒíƒœ ë™ê¸°í™”
- MQTT ë©”ì‹œì§€ ìˆ˜ì‹  ë° ì‹œê°í™”
- ì„¼ì„œ ë°ì´í„° ì˜êµ¬ ì €ì¥ (í™•ì¥ ì‹œë‚˜ë¦¬ì˜¤)
- ì‚¬ìš©ìë³„ ë°ì´í„° ê²©ë¦¬

**ë¹„ê¸°ëŠ¥ì  ìš”êµ¬ì‚¬í•­**:

- ê¸€ë¡œë²Œ ë°°í¬ ë° ìë™ í™•ì¥
- 99.9% ì´ìƒì˜ ê°€ìš©ì„±
- ì‹¤ì‹œê°„ ë™ê¸°í™” ì§€ì—° < 500ms
- ë³´ì•ˆ ë‚´ì¬í™” (OWASP Top 10 ëŒ€ì‘)

### ê¸°ìˆ  ìŠ¤íƒ ì„ íƒ ëª©í‘œ

ìƒìš© ì„œë¹„ìŠ¤ í™œìš©ìœ¼ë¡œ ìµœëŒ€ í¼í¬ë¨¼ìŠ¤ ë‹¬ì„± + ì ì§„ì  í™•ì¥ì„± í™•ë³´

---

## ğŸ›ï¸ ì•„í‚¤í…ì²˜ ê°œìš”

### Phaseë³„ ì§„í™” ì „ëµ

#### **Phase 1: Serverless-First MVP**

ë°±ì—”ë“œ ì„œë²„ ì—†ì´ Firebase + AWS ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ë¡œ ì™„ì „í•œ IoT í”Œë«í¼ êµ¬ì„±

```
ì‚¬ìš©ì â†’ AWS Amplify (CDN + í˜¸ìŠ¤íŒ…)
         â†“
    Firebase Auth (ì¸ì¦)
         â†“
    Firestore (ì‹¤ì‹œê°„ DB)
         â†“
    MQTT Broker (ì‹¤ì‹œê°„ ë©”ì‹œì§€)
```

**íŠ¹ì§•**:

- âœ… ì„œë²„ ìš´ì˜ ë¶€ë‹´ ì œë¡œ
- âœ… Firebase ìë™ í™•ì¥
- âœ… ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”
- âœ… ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ê³¼ê¸ˆ

**ì í•©í•œ ê²½ìš°**:

- MVP ë¹ ë¥¸ ì¶œì‹œê°€ ìµœìš°ì„ 
- ì‚¬ìš©ì ìˆ˜ < 10,000ëª…
- ë‹¨ìˆœí•œ CRUD ì¤‘ì‹¬ ì„œë¹„ìŠ¤

---

#### **Phase 2: í•˜ì´ë¸Œë¦¬ë“œ ì•„í‚¤í…ì²˜ (í˜„ì¬ êµ¬í˜„)**

FirebaseëŠ” ì¸ì¦Â·ì‹¤ì‹œê°„ ë°ì´í„°ì— ì§‘ì¤‘, Express ë°±ì—”ë“œë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§Â·ì˜êµ¬ ì €ì¥ ì²˜ë¦¬

```
ì‚¬ìš©ì â†’ Amplify â†’ Frontend
              â†“
         Firebase Auth (ì¸ì¦Â·í† í°)
              â†“
      â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
      â†“             â†“
  Firestore    Express Backend
 (ì‹¤ì‹œê°„ ìƒíƒœ)   (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)
                    â†“
                  MySQL
              (ì„¼ì„œ ë°ì´í„° ì˜êµ¬ ì €ì¥)
```

**ì„¤ê³„ ì›ì¹™**:

- âœ… **ê´€ë¦¬í˜• ìš°ì„ **: ì¸ì¦Â·ì‹¤ì‹œê°„ DBëŠ” Firebase
- âœ… **ìœ ì—°í•œ í™•ì¥**: ë³µì¡í•œ ë¡œì§ì€ Expressë¡œ ì²˜ë¦¬
- âœ… **ë°ì´í„° ë¶„ë¦¬**: ì‹¤ì‹œê°„ vs ì˜êµ¬ ì €ì¥ì†Œ ë¶„ë¦¬
- âœ… **ë³´ì•ˆ ë‚´ì¬í™”**: Firebase ID í† í° ê¸°ë°˜ ì¸ì¦

**Phase 2ë¡œ ì „í™˜í•´ì•¼ í•˜ëŠ” ì‹œì **:

- â— ë³µì¡í•œ ë°ì´í„° ë¶„ì„ì´ í•„ìš”í•  ë•Œ
- â— ì™¸ë¶€ ì‹œìŠ¤í…œ(ERP, CRM) ì—°ë™ì´ í•„ìš”í•  ë•Œ
- â— ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…(ë°°ì¹˜, ì•Œë¦¼)ì´ í•„ìš”í•  ë•Œ
- â— ê°ì‚¬ ë¡œê·¸ ë° íŠ¸ëœì­ì…˜ ì²˜ë¦¬ê°€ í•„ìš”í•  ë•Œ

---

### ğŸ“Š Phase ë¹„êµ: ë¬´ì—‡ì´ ë‹¬ë¼ì§€ë‚˜?

|í•­ëª©|Phase 1 (Firebase Only)|Phase 2 (Hybrid)|
|---|---|---|
|**ì¸ì¦**|Firebase Auth|Firebase Auth (ë™ì¼)|
|**ì‹¤ì‹œê°„ ë°ì´í„°**|Firestore|Firestore (ìœ ì§€)|
|**ì˜êµ¬ ì €ì¥**|Firestore|â• MySQL|
|**ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**|Frontend|â• Express API|
|**ë³µì¡í•œ ì¿¼ë¦¬**|ì œí•œì |â• SQL í™œìš©|
|**ì™¸ë¶€ ì—°ë™**|ë¶ˆê°€ëŠ¥|â• ERP/CRM ì—°ë™|
|**ë°°ì¹˜ ì‘ì—…**|ë¶ˆê°€ëŠ¥|â• Cron/Scheduler|
|**ë°°í¬**|Amplify|Amplify + ECS/Fargate|
|**ì˜ˆìƒ ë¹„ìš©**|$0-50/ì›”|$50-200/ì›”|
|**ìš´ì˜ ë³µì¡ë„**|â˜…â˜†â˜†â˜†â˜†|â˜…â˜…â˜…â˜†â˜†|
|**í™•ì¥ì„±**|ìë™ (ì œí•œì )|ìˆ˜ë™ + ìë™ (ìœ ì—°í•¨)|

---

## ğŸ”§ ê¸°ìˆ  ìŠ¤íƒ

### í”„ë¡ íŠ¸ì—”ë“œ

|ê³„ì¸µ|ê¸°ìˆ |ë²„ì „|ì„ íƒ ì´ìœ |
|---|---|---|---|
|**ë¹Œë“œ ë„êµ¬**|Vite|^5.0.0|ë¹ ë¥¸ ê°œë°œ ì„œë²„ (ESBuild), ìµœì í™”ëœ ë²ˆë“¤ë§, HMR ì§€ì›|
|**í”„ë ˆì„ì›Œí¬**|Vanilla JS|-|ê²½ëŸ‰í™”, í•™ìŠµ ì§„ì…ì¥ë²½ ìµœì†Œí™”, í”„ë ˆì„ì›Œí¬ ë…ë¦½ì„±|
|**ì¸ì¦Â·DB**|Firebase SDK|^10.8.0|Auth + Firestore í†µí•©, ì‹¤ì‹œê°„ ë™ê¸°í™”, ì˜¤í”„ë¼ì¸ ìºì‹±|
|**ìŠ¤íƒ€ì¼**|Tailwind CSS|CDN|ìœ í‹¸ë¦¬í‹° ê¸°ë°˜ ë¹ ë¥¸ UI êµ¬ì„±, ì¼ê´€ëœ ë””ìì¸ ì‹œìŠ¤í…œ|
|**ì‹¤ì‹œê°„ í†µì‹ **|MQTT.js|-|IoT í‘œì¤€ í”„ë¡œí† ì½œ, WebSocket ì§€ì›, QoS ë ˆë²¨ ê´€ë¦¬|
|**ì°¨íŠ¸**|Chart.js|-|ê°„ë‹¨í•œ ì‹œê°í™”, ë°˜ì‘í˜• ì°¨íŠ¸, ì• ë‹ˆë©”ì´ì…˜|
|**í˜¸ìŠ¤íŒ…**|AWS Amplify|-|Git ì—°ë™ ìë™ ë°°í¬, CloudFront CDN, SSL ìë™ ê´€ë¦¬|

#### Firebase í•µì‹¬ ê¸°ëŠ¥ ìƒì„¸

**Firebase Auth**:

- Email/Google OAuth ì¦‰ì‹œ ì‚¬ìš©
- ID í† í° ìë™ ê´€ë¦¬ ë° ê°±ì‹ 
- ë‹¤ì¤‘ ì œê³µì—…ì²´ ì—°ë™ (Facebook, GitHub ë“± ì¶”ê°€ ê°€ëŠ¥)
- ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •, ì´ë©”ì¼ ì¸ì¦ ìë™ ì§€ì›

**Firestore**:

- `onSnapshot` ì‹¤ì‹œê°„ ë™ê¸°í™” (WebSocket ê¸°ë°˜)
- ì˜¤í”„ë¼ì¸ ìºì‹± ë° ìë™ ì¬ë™ê¸°í™”
- ìë™ í™•ì¥ (íŠ¸ë˜í”½ ì¦ê°€ ì‹œ ë¬´ì¤‘ë‹¨)
- Security Rulesë¡œ ì‚¬ìš©ìë³„ ë°ì´í„° ê²©ë¦¬

**ì„ íƒ ê·¼ê±°**:

- **ë¹ ë¥¸ ê°œë°œ**: ì„œë²„ êµ¬ì¶• ì—†ì´ ì¸ì¦ + ì‹¤ì‹œê°„ DB
- **ìë™ ê´€ë¦¬**: í™•ì¥, ë°±ì—…, ë³´ì•ˆ ëª¨ë‘ ìë™
- **ë¹„ìš© íš¨ìœ¨**: ë¬´ë£Œ í• ë‹¹ëŸ‰ + ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ê³¼ê¸ˆ

---

### ë°±ì—”ë“œ (ì„ íƒì  í™•ì¥ - Phase 2)

|ê³„ì¸µ|ê¸°ìˆ |ë²„ì „|ì„ íƒ ì´ìœ |
|---|---|---|---|
|**ëŸ°íƒ€ì„**|Node.js|â‰¥18.17.0|JavaScript ìƒíƒœê³„ í™œìš©, í”„ë¡ íŠ¸ì—”ë“œì™€ ë™ì¼ ì–¸ì–´|
|**í”„ë ˆì„ì›Œí¬**|Express|^4.19.2|ê°„ê²°í•œ API êµ¬ì„±, í’ë¶€í•œ ë¯¸ë“¤ì›¨ì–´ ìƒíƒœê³„, í•™ìŠµ ê³¡ì„  ì™„ë§Œ|
|**ì–¸ì–´**|TypeScript|^5.4.5|íƒ€ì… ì•ˆì „ì„±, IDE ìë™ ì™„ì„±, ë¦¬íŒ©í† ë§ ìš©ì´|
|**ì¸ì¦**|Firebase Admin|^12.5.0|ID í† í° ì„œë²„ ê²€ì¦, ì‚¬ìš©ì ê´€ë¦¬ API|
|**ë°ì´í„°ë² ì´ìŠ¤**|MySQL|8.0|ê´€ê³„í˜• ë°ì´í„°, ACID íŠ¸ëœì­ì…˜, ë³µì¡í•œ JOIN ì¿¼ë¦¬|
|**DB í´ë¼ì´ì–¸íŠ¸**|mysql2|^3.9.4|Promise ê¸°ë°˜ ì¿¼ë¦¬, ì»¤ë„¥ì…˜ í’€ ê´€ë¦¬|
|**ê²€ì¦**|Zod|^3.23.8|ìŠ¤í‚¤ë§ˆ ê¸°ë°˜ ëŸ°íƒ€ì„ ê²€ì¦, TypeScript íƒ€ì… ì¶”ë¡ |
|**ë¡œê¹…**|Pino|^9.4.0|ê³ ì„±ëŠ¥ êµ¬ì¡°í™” ë¡œê¹…, JSON í˜•ì‹ ì¶œë ¥|
|**CORS**|cors|^2.8.5|í¬ë¡œìŠ¤ ë„ë©”ì¸ ìš”ì²­ ê´€ë¦¬, í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ì„¤ì •|

#### ë°±ì—”ë“œ í•µì‹¬ ì—­í• 

**Firebase ID í† í° ê²€ì¦**:

```typescript
// Firebase Admin SDKë¡œ í´ë¼ì´ì–¸íŠ¸ í† í° ê²€ì¦
const decodedToken = await admin.auth().verifyIdToken(idToken);
const userId = decodedToken.uid;
```

**ì„¼ì„œ ë°ì´í„° MySQL ì˜êµ¬ ì €ì¥**:

```sql
-- FirestoreëŠ” ì‹¤ì‹œê°„ ìƒíƒœë§Œ, MySQLì€ íˆìŠ¤í† ë¦¬ ì €ì¥
INSERT INTO sensor_readings (device_id, payload, recorded_at)
VALUES (?, ?, NOW());
```

**ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬**:

```typescript
// ë°°í„°ë¦¬ ë¶€ì¡± ë””ë°”ì´ìŠ¤ ì°¾ì•„ ì´ë©”ì¼ ë°œì†¡
@Cron('0 */6 * * *')
async checkLowBattery() {
  const devices = await this.deviceService.getLowBatteryDevices();
  for (const device of devices) {
    await this.emailService.sendAlert(device.owner.email);
  }
}
```

**ì™¸ë¶€ API ì—°ë™ (ë¯¸ë˜ í™•ì¥)**:

- ERP ì‹œìŠ¤í…œ ì—°ë™
- CRM ë°ì´í„° ë™ê¸°í™”
- ê²°ì œ ê²Œì´íŠ¸ì›¨ì´ ì—°ë™

---

### ì¸í”„ë¼ ë° ë°°í¬

|í•­ëª©|ê¸°ìˆ |ì—­í• |ì„ íƒ ì´ìœ |
|---|---|---|---|
|**CDN**|CloudFront|ê¸€ë¡œë²Œ ì½˜í…ì¸  ì „ì†¡, DDoS ë°©ì–´|180+ ì—£ì§€ ë¡œì¼€ì´ì…˜, AWS Shield í†µí•©|
|**í˜¸ìŠ¤íŒ…**|AWS Amplify|ìë™ ë¹Œë“œÂ·ë°°í¬, SSL ê´€ë¦¬|Git push íŠ¸ë¦¬ê±°, í™˜ê²½ë³„ ë°°í¬, ë¡¤ë°± ê°„í¸|
|**ì»¨í…Œì´ë„ˆ**|Docker|MySQL ë¡œì»¬ ê°œë°œ í™˜ê²½|í™˜ê²½ ì¼ê´€ì„±, ë¹ ë¥¸ ì„¤ì •|
|**ë²„ì „ ê´€ë¦¬**|Git|ì†ŒìŠ¤ ê´€ë¦¬, Amplify ì—°ë™|ë¸Œëœì¹˜ë³„ ë°°í¬, PR í”„ë¦¬ë·°|

---

## ğŸŒ í”Œë«í¼ ë””ìì¸

### ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    subgraph "User Layer"
        U[ì‚¬ìš©ì<br/>Web Browser]
    end

    subgraph "CDN & Hosting Layer"
        CDN[CloudFront CDN<br/>ê¸€ë¡œë²Œ ì—£ì§€]
        AMP[AWS Amplify<br/>ì •ì  í˜¸ìŠ¤íŒ…]
    end

    subgraph "Frontend Application"
        FE[Vite Frontend<br/>Vanilla JS + Tailwind]
    end

    subgraph "Authentication & Real-time Layer"
        AUTH[Firebase Auth<br/>ì¸ì¦Â·í† í° ê´€ë¦¬]
        FS[Firestore<br/>ì‹¤ì‹œê°„ DB]
    end

    subgraph "Backend Layer (Phase 2)"
        API[Express API<br/>TypeScript]
    end

    subgraph "Data Layer"
        DB[(MySQL<br/>ì„¼ì„œ ë°ì´í„°)]
    end

    subgraph "IoT Layer"
        MQTT[MQTT Broker<br/>HiveMQ/Mosquitto]
    end

    U -->|HTTPS| CDN
    CDN --> AMP
    AMP --> FE
    FE -->|SDK| AUTH
    FE -->|SDK| FS
    FE -->|REST API| API
    FE -.->|WebSocket| MQTT
    API -->|Verify Token| AUTH
    API -->|SQL| DB
    AUTH -.->|Security Rules| FS
```

**ì•„í‚¤í…ì²˜ íë¦„ ì„¤ëª…**:

1. **ì‚¬ìš©ì ì ‘ê·¼**: HTTPSë¡œ CloudFront CDN ì ‘ê·¼
2. **ì •ì  ì½˜í…ì¸  ì„œë¹™**: Amplifyì—ì„œ ë¹Œë“œëœ SPA ì œê³µ
3. **ì¸ì¦**: Firebase Auth SDKë¡œ ë¡œê·¸ì¸
4. **ì‹¤ì‹œê°„ ë°ì´í„°**: Firestore onSnapshotìœ¼ë¡œ êµ¬ë…
5. **MQTT ë©”ì‹œì§€**: WebSocketìœ¼ë¡œ ì„¼ì„œ ë°ì´í„° ìˆ˜ì‹ 
6. **ë°±ì—”ë“œ API** (Phase 2): Expressë¡œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì²˜ë¦¬
7. **ì˜êµ¬ ì €ì¥**: MySQLì— ì„¼ì„œ íˆìŠ¤í† ë¦¬ ì €ì¥

---

### ë°ì´í„° í”Œë¡œìš°

```mermaid
sequenceDiagram
    participant U as ì‚¬ìš©ì
    participant FE as Frontend
    participant AUTH as Firebase Auth
    participant FS as Firestore
    participant API as Express API
    participant DB as MySQL
    participant MQTT as MQTT Broker

    Note over U,AUTH: 1. ì¸ì¦ í”Œë¡œìš°
    U->>FE: Google ë¡œê·¸ì¸ í´ë¦­
    FE->>AUTH: signInWithPopup()
    AUTH-->>FE: User + ID Token

    Note over FE,FS: 2. ì‹¤ì‹œê°„ ë””ë°”ì´ìŠ¤ ë™ê¸°í™”
    FE->>FS: onSnapshot(devices)
    FS-->>FE: ì‹¤ì‹œê°„ ë””ë°”ì´ìŠ¤ ëª©ë¡

    Note over FE,MQTT: 3. MQTT ë©”ì‹œì§€ ìˆ˜ì‹ 
    MQTT->>FE: ì˜¨ë„ ì„¼ì„œ ë°ì´í„°
    FE->>FS: updateDoc(device, {lastTemp})
    FS-->>FE: ë³€ê²½ ì•Œë¦¼ â†’ UI ì—…ë°ì´íŠ¸

    Note over FE,DB: 4. ì„¼ì„œ ë°ì´í„° ì˜êµ¬ ì €ì¥ (Phase 2)
    FE->>API: POST /api/sensors/data (+ ID Token)
    API->>AUTH: verifyIdToken()
    AUTH-->>API: Verified User
    API->>DB: INSERT sensor_readings
    DB-->>API: Success
    API-->>FE: 200 OK
```

---

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
aiot-dev-mgr-cld/
â”œâ”€â”€ aiot-device-manager-fe-working/    # í”„ë¡ íŠ¸ì—”ë“œ
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/                    # ì„¤ì • íŒŒì¼
â”‚   â”‚   â”‚   â”œâ”€â”€ firebase.config.js     # Firebase SDK ì„¤ì •
â”‚   â”‚   â”‚   â”œâ”€â”€ app.config.js          # ì•± ê°œì¸í™” ì„¤ì • (MQTT, í…Œë§ˆ)
â”‚   â”‚   â”‚   â””â”€â”€ backend.config.js      # ë°±ì—”ë“œ API URL
â”‚   â”‚   â”œâ”€â”€ services/                  # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”‚   â”œâ”€â”€ FirebaseTokenManager.js    # í† í° ìºì‹± (2~10ë¶„)
â”‚   â”‚   â”‚   â”œâ”€â”€ BackendIntegrationService.js # API í†µì‹ 
â”‚   â”‚   â”‚   â””â”€â”€ sensorApi.js           # ì„¼ì„œ ë°ì´í„° API
â”‚   â”‚   â”œâ”€â”€ views/                     # í™”ë©´ ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthView.js            # ë¡œê·¸ì¸ í™”ë©´
â”‚   â”‚   â”‚   â”œâ”€â”€ DeviceListView.js      # ë””ë°”ì´ìŠ¤ ëª©ë¡
â”‚   â”‚   â”‚   â””â”€â”€ DeviceDetailView.js    # ë””ë°”ì´ìŠ¤ ìƒì„¸
â”‚   â”‚   â”œâ”€â”€ components/                # UI ì»´í¬ë„ŒíŠ¸
â”‚   â”‚   â”‚   â”œâ”€â”€ DeviceAddForm.js       # ë””ë°”ì´ìŠ¤ ì¶”ê°€ í¼
â”‚   â”‚   â”‚   â”œâ”€â”€ MQTTManager.js         # MQTT êµ¬ë… ê´€ë¦¬
â”‚   â”‚   â”‚   â””â”€â”€ TemperatureChart.js    # ì‹¤ì‹œê°„ ì°¨íŠ¸
â”‚   â”‚   â”œâ”€â”€ AppManager.js              # ì•± ì „ì²´ ìƒíƒœ ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ app.js                     # ì§„ì…ì 
â”‚   â”œâ”€â”€ index.html                     # HTML ì—”íŠ¸ë¦¬ (Tailwind CDN)
â”‚   â”œâ”€â”€ vite.config.js                 # Vite ë¹Œë“œ ì„¤ì •
â”‚   â”œâ”€â”€ amplify.yml                    # AWS Amplify ë°°í¬ ì„¤ì •
â”‚   â””â”€â”€ package.json                   # ì˜ì¡´ì„± ê´€ë¦¬
â”‚
â”œâ”€â”€ aiot-device-manager-be-working/    # ë°±ì—”ë“œ (Phase 2)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â”‚   â”œâ”€â”€ env.ts                 # í™˜ê²½ ë³€ìˆ˜ ê²€ì¦ (Zod)
â”‚   â”‚   â”‚   â””â”€â”€ firebase.ts            # Firebase Admin ì´ˆê¸°í™”
â”‚   â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”‚   â””â”€â”€ firebaseAuth.ts        # ID í† í° ê²€ì¦ ë¯¸ë“¤ì›¨ì–´
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â””â”€â”€ sensorRoutes.ts        # POST /api/sensors/data
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â””â”€â”€ sensorService.ts       # ì„¼ì„œ ë°ì´í„° ì €ì¥ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â”‚   â””â”€â”€ pool.ts                # MySQL ì»¤ë„¥ì…˜ í’€
â”‚   â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”‚   â””â”€â”€ logger.ts              # Pino ë¡œê¹…
â”‚   â”‚   â”œâ”€â”€ app.ts                     # Express ì•± ì„¤ì •
â”‚   â”‚   â””â”€â”€ server.ts                  # ì„œë²„ ì‹œì‘
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â””â”€â”€ schema.sql                 # MySQL DDL
â”‚   â”œâ”€â”€ docker-compose.yml             # MySQL ì»¨í…Œì´ë„ˆ
â”‚   â”œâ”€â”€ tsconfig.json                  # TypeScript ì„¤ì •
â”‚   â””â”€â”€ package.json                   # ì˜ì¡´ì„± ê´€ë¦¬
â”‚
â””â”€â”€ docs/                              # ë¬¸ì„œ
    â”œâ”€â”€ 2.0ì•„í‚¤í…ì²˜.md                  # ë³¸ ë¬¸ì„œ
    â”œâ”€â”€ CLOUD_DEPLOYMENT_GUIDE.md      # ë°°í¬ ê°€ì´ë“œ
    â””â”€â”€ SECURITY_REVIEW.md             # ë³´ì•ˆ ê²€í† 
```

---

## ğŸ” API ëª…ì„¸ì„œ

### Firebase Auth API (í´ë¼ì´ì–¸íŠ¸)

#### Google OAuth ë¡œê·¸ì¸

```javascript
import { signInWithPopup, GoogleAuthProvider } from 'firebase/auth';

const provider = new GoogleAuthProvider();
const result = await signInWithPopup(auth, provider);
const user = result.user;
const idToken = await user.getIdToken(); // 1ì‹œê°„ ìœ íš¨
```

#### ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸

```javascript
import { signInWithEmailAndPassword } from 'firebase/auth';

await signInWithEmailAndPassword(auth, email, password);
```

#### í† í° ìë™ ê°±ì‹  ê°ì§€

```javascript
import { onIdTokenChanged } from 'firebase/auth';

onIdTokenChanged(auth, async (user) => {
  if (user) {
    const token = await user.getIdToken(); // ìë™ ê°±ì‹ 
    // API í˜¸ì¶œ ì‹œ Authorization í—¤ë”ì— í¬í•¨
  }
});
```

#### ë¡œê·¸ì•„ì›ƒ

```javascript
import { signOut } from 'firebase/auth';

await signOut(auth);
```

---

### Firestore API (í´ë¼ì´ì–¸íŠ¸)

#### ì‹¤ì‹œê°„ êµ¬ë… (ì‚¬ìš©ìë³„ ë””ë°”ì´ìŠ¤ë§Œ ì¡°íšŒ)

```javascript
import { collection, onSnapshot, query, where } from 'firebase/firestore';

const q = query(
  collection(db, 'devices'),
  where('userId', '==', auth.currentUser.uid)
);

const unsubscribe = onSnapshot(q, (snapshot) => {
  snapshot.docChanges().forEach(change => {
    if (change.type === 'added') {
      console.log('ìƒˆ ë””ë°”ì´ìŠ¤:', change.doc.data());
    }
    if (change.type === 'modified') {
      console.log('ìƒíƒœ ë³€ê²½:', change.doc.data());
    }
    if (change.type === 'removed') {
      console.log('ì‚­ì œë¨:', change.doc.data());
    }
  });
});

// êµ¬ë… í•´ì œ
unsubscribe();
```

#### ë””ë°”ì´ìŠ¤ ì¶”ê°€

```javascript
import { addDoc, collection } from 'firebase/firestore';

await addDoc(collection(db, 'devices'), {
  userId: auth.currentUser.uid,
  name: 'ê±°ì‹¤ ì˜¨ë„ì„¼ì„œ',
  type: 'sensor',
  status: 'online',
  location: 'ê±°ì‹¤',
  batteryLevel: 100,
  createdAt: new Date()
});
```

#### ë””ë°”ì´ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸

```javascript
import { updateDoc, doc } from 'firebase/firestore';

await updateDoc(doc(db, 'devices', deviceId), {
  status: 'offline',
  lastSeen: new Date()
});
```

#### ë””ë°”ì´ìŠ¤ ì‚­ì œ

```javascript
import { deleteDoc, doc } from 'firebase/firestore';

await deleteDoc(doc(db, 'devices', deviceId));
```

---

### Express Backend API (Phase 2)

#### ì—”ë“œí¬ì¸íŠ¸ ëª©ë¡

|Method|Path|ì¸ì¦|ì„¤ëª…|
|---|---|---|---|
|GET|`/health`|ë¶ˆí•„ìš”|í—¬ìŠ¤ ì²´í¬|
|POST|`/api/sensors/data`|í•„ìˆ˜|ì„¼ì„œ ë°ì´í„° ì €ì¥|

#### ì„¼ì„œ ë°ì´í„° ì €ì¥

**Request**:

```http
POST /api/sensors/data
Authorization: Bearer <firebase-id-token>
Content-Type: application/json

{
  "deviceId": "device123",
  "temperature": 23.5,
  "humidity": 60,
  "timestamp": "2025-08-15T10:30:00Z"
}
```

**Response** (ì„±ê³µ):

```json
{
  "success": true,
  "readingId": 12345
}
```

**Response** (ì—ëŸ¬):

```json
{
  "error": "Unauthorized",
  "message": "Invalid or expired token"
}
```

---

### Firestore Security Rules

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // ë””ë°”ì´ìŠ¤: ë³¸ì¸ ê²ƒë§Œ ì ‘ê·¼
    match /devices/{deviceId} {
      allow read, write: if request.auth != null
        && request.auth.uid == resource.data.userId;

      allow create: if request.auth != null
        && request.auth.uid == request.resource.data.userId;
    }

    // ì‚¬ìš©ì í”„ë¡œí•„: ë³¸ì¸ ê²ƒë§Œ ì ‘ê·¼
    match /users/{userId} {
      allow read, write: if request.auth != null
        && request.auth.uid == userId;
    }
  }
}
```

**ë³´ì•ˆ ê·œì¹™ ì„¤ëª…**:

- `request.auth`: í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ì •ë³´
- `resource.data`: ê¸°ì¡´ ë¬¸ì„œ ë°ì´í„°
- `request.resource.data`: ìƒˆë¡œ ì‘ì„±/ìˆ˜ì •í•  ë°ì´í„°

---

### MySQL ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

#### í…Œì´ë¸” êµ¬ì¡°

**users**: Firebase ì‚¬ìš©ì ì •ë³´

```sql
CREATE TABLE users (
  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  firebase_uid VARCHAR(128) UNIQUE NOT NULL,
  email VARCHAR(255),
  display_name VARCHAR(255),
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  INDEX idx_firebase_uid (firebase_uid)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**devices**: ë””ë°”ì´ìŠ¤ ì •ë³´

```sql
CREATE TABLE devices (
  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  user_id BIGINT UNSIGNED NOT NULL,
  device_id VARCHAR(128) NOT NULL,
  device_name VARCHAR(255),
  last_seen_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  UNIQUE KEY uk_user_device (user_id, device_id),
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**sensor_readings**: ì„¼ì„œ ë°ì´í„° (Append-Only)

```sql
CREATE TABLE sensor_readings (
  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,
  device_id BIGINT UNSIGNED NOT NULL,
  recorded_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  payload JSON NOT NULL,
  KEY idx_device_time (device_id, recorded_at),
  FOREIGN KEY (device_id) REFERENCES devices(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

**ë°ì´í„° í”Œë¡œìš°**:

1. Frontendì—ì„œ Firebase Authë¡œ ì¸ì¦
2. Firebase ID Tokenì„ Backendë¡œ ì „ì†¡
3. Backendì—ì„œ Token ê²€ì¦ â†’ Firebase UID ì¶”ì¶œ
4. `users` í…Œì´ë¸”ì—ì„œ ì‚¬ìš©ì ì¡°íšŒ/ìƒì„±
5. `devices` í…Œì´ë¸”ì—ì„œ ë””ë°”ì´ìŠ¤ ì¡°íšŒ/ìƒì„±
6. `sensor_readings` í…Œì´ë¸”ì— ì„¼ì„œ ë°ì´í„° ì €ì¥

---

## âš™ï¸ í™˜ê²½ êµ¬ì„± ê°€ì´ë“œ

### 1. Firebase í”„ë¡œì íŠ¸ ì„¤ì •

**Firebase Consoleì—ì„œ ìˆ˜í–‰**:

1. [Firebase Console](https://console.firebase.google.com/) ì ‘ì†
2. í”„ë¡œì íŠ¸ ìƒì„± (í”„ë¡œì íŠ¸ ì´ë¦„ ì…ë ¥)
3. **Authentication** í™œì„±í™”
    - Email/Password í™œì„±í™”
    - Google OAuth í™œì„±í™”
    - ì„¤ì • â†’ ìŠ¹ì¸ëœ ë„ë©”ì¸ ì¶”ê°€: `localhost`, `*.amplifyapp.com`
4. **Firestore Database** ìƒì„± (í”„ë¡œë•ì…˜ ëª¨ë“œ ì„ íƒ)
5. **Security Rules** ì ìš© (ìœ„ API ëª…ì„¸ì„œ ì°¸ì¡°)
6. **ì›¹ ì•± ë“±ë¡** â†’ Firebase êµ¬ì„± ê°ì²´ ë³µì‚¬

**Firebase êµ¬ì„± ê°ì²´ ì˜ˆì‹œ**:

```javascript
{
  apiKey: "AIzaSyXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX",
  authDomain: "your-project.firebaseapp.com",
  projectId: "your-project-id",
  storageBucket: "your-project.appspot.com",
  messagingSenderId: "123456789012",
  appId: "1:123456789012:web:abcdefghijklmnop"
}
```

---

### 2. í”„ë¡ íŠ¸ì—”ë“œ ë¡œì»¬ í™˜ê²½ ì„¤ì •

```bash
cd aiot-device-manager-fe-working

# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
```

**.env íŒŒì¼**:

```bash
# Firebase SDK ì„¤ì •
VITE_FIREBASE_API_KEY=your-api-key
VITE_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=your-project-id
VITE_FIREBASE_STORAGE_BUCKET=your-project.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=123456789
VITE_FIREBASE_APP_ID=1:123456789:web:abcdef

# ë°±ì—”ë“œ API URL (Phase 2)
VITE_BACKEND_BASE_URL=http://localhost:4000

# í† í° ìºì‹± ì‹œê°„ (ë¶„)
VITE_TOKEN_CACHE_MINUTES=5
```

**ê°œë°œ ì„œë²„ ì‹¤í–‰**:

```bash
npm run dev
# http://localhost:5173 ì ‘ì†
```

---

### 3. ë°±ì—”ë“œ ë¡œì»¬ í™˜ê²½ ì„¤ì • (Phase 2)

```bash
cd aiot-device-manager-be-working

# ì˜ì¡´ì„± ì„¤ì¹˜
npm install

# í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
cp .env.example .env
```

**.env íŒŒì¼**:

```bash
# Express ì„œë²„
PORT=4000

# MySQL ì—°ê²°
MYSQL_HOST=127.0.0.1
MYSQL_PORT=3306
MYSQL_USER=appuser
MYSQL_PASSWORD=appsecret
MYSQL_DATABASE=aiot_device_manager

# Firebase Admin SDK
FIREBASE_PROJECT_ID=your-project-id
FIREBASE_CLIENT_EMAIL=firebase-adminsdk@your-project.iam.gserviceaccount.com
FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"

# CORS í—ˆìš© ë„ë©”ì¸
ALLOWED_ORIGINS=http://localhost:5173,https://your-app.amplifyapp.com
```

**Firebase ì„œë¹„ìŠ¤ ê³„ì • í‚¤ ë°œê¸‰**:

1. Firebase Console â†’ í”„ë¡œì íŠ¸ ì„¤ì • â†’ ì„œë¹„ìŠ¤ ê³„ì •
2. "ìƒˆ ë¹„ê³µê°œ í‚¤ ìƒì„±" í´ë¦­ â†’ JSON ë‹¤ìš´ë¡œë“œ
3. JSON íŒŒì¼ì—ì„œ `client_email`, `private_key` ì¶”ì¶œ
4. `.env`ì— ë¶™ì—¬ë„£ê¸° (ì¤„ë°”ê¿ˆ `\n` ìœ ì§€)

**MySQL ì»¨í…Œì´ë„ˆ ì‹¤í–‰**:

```bash
docker compose up -d
# MySQL 8.0 ì»¨í…Œì´ë„ˆ ì‹œì‘
# schema.sql ìë™ ì‹¤í–‰
```

**ë°±ì—”ë“œ ì„œë²„ ì‹¤í–‰**:

```bash
npm run dev
# http://localhost:4000
```

---

### 4. MQTT ë¸Œë¡œì»¤ ì„¤ì •

**app.config.jsì—ì„œ ë¸Œë¡œì»¤ ì„ íƒ**:

```javascript
mqtt: {
  brokerOption: "broker-option1", // ë³€ê²½ ê°€ëŠ¥

  brokerOptions: {
    "broker-option1": {
      name: "HiveMQ Public Broker",
      url: "ws://broker.hivemq.com:8000/mqtt"
    },
    "broker-option4": {
      name: "Mosquitto Test Broker",
      url: "ws://test.mosquitto.org:8080/mqtt"
    },
    // ë¡œì»¬ ë¸Œë¡œì»¤ ì‚¬ìš© ì‹œ
    "broker-option6": {
      name: "Local Mosquitto Broker",
      url: "ws://localhost:9001/mqtt"
    }
  },

  // í† í”½ ê°œì¸í™” (ë‹¤ë¥¸ ìˆ˜ê°•ìƒê³¼ ì¤‘ë³µ ë°©ì§€)
  topicPrefix: "kiot/your-unique-id/"
}
```

**ë¡œì»¬ Mosquitto ì„¤ì¹˜ (ì„ íƒì‚¬í•­)**:

```bash
# macOS
brew install mosquitto

# Ubuntu
sudo apt-get install mosquitto mosquitto-clients

# ì‹¤í–‰
mosquitto -c /usr/local/etc/mosquitto/mosquitto.conf
```

---

## âœ… Phase 1 ì‹¤ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì˜ˆìƒ ì†Œìš” ì‹œê°„: 4ì‹œê°„

#### 1ë‹¨ê³„: Firebase ì„¤ì • (30ë¶„)

- [ ] Firebase í”„ë¡œì íŠ¸ ìƒì„±
- [ ] Authentication í™œì„±í™” (Email + Google)
- [ ] Firestore ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
- [ ] ë³´ì•ˆ ê·œì¹™ ì ìš©
- [ ] ì›¹ ì•± ë“±ë¡ â†’ config ë³µì‚¬

#### 2ë‹¨ê³„: ë¡œì»¬ ê°œë°œ í™˜ê²½ (30ë¶„)

- [ ] `git clone` í›„ `npm install`
- [ ] `.env` íŒŒì¼ ì„¤ì • (Firebase config ì…ë ¥)
- [ ] `npm run dev` ì‹¤í–‰ â†’ http://localhost:5173 í™•ì¸
- [ ] ë¸Œë¼ìš°ì € ì½˜ì†”ì—ì„œ ì—ëŸ¬ ì—†ëŠ”ì§€ í™•ì¸

#### 3ë‹¨ê³„: ê¸°ëŠ¥ êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸ (2ì‹œê°„)

- [ ] Google ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
- [ ] ì´ë©”ì¼ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
- [ ] ë””ë°”ì´ìŠ¤ ì¶”ê°€ (ì„¼ì„œ, ì•¡ì¶”ì—ì´í„° ê° 1ê°œì”©)
- [ ] ë””ë°”ì´ìŠ¤ ìƒíƒœ ë³€ê²½ (online â†” offline)
- [ ] ë””ë°”ì´ìŠ¤ ì‚­ì œ
- [ ] ì‹¤ì‹œê°„ ë™ê¸°í™” í™•ì¸ (ì—¬ëŸ¬ íƒ­ì—ì„œ ë™ì‹œ í…ŒìŠ¤íŠ¸)
- [ ] MQTT ë©”ì‹œì§€ ìˆ˜ì‹  í…ŒìŠ¤íŠ¸ (MQTTX ì‚¬ìš©)

#### 4ë‹¨ê³„: Amplify ë°°í¬ (1ì‹œê°„)

- [ ] GitHub ì €ì¥ì†Œ ìƒì„± ë° í‘¸ì‹œ
- [ ] Amplify Console ì—°ê²°
- [ ] í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (VITE_FIREBASE_*)
- [ ] ë¹Œë“œ ì„±ê³µ í™•ì¸
- [ ] ë°°í¬ URL ì ‘ì† í™•ì¸
- [ ] Firebase Consoleì— Amplify URL ì¶”ê°€

#### 5ë‹¨ê³„: ê²€ì¦ (30ë¶„)

- [ ] ë°°í¬ëœ URLì—ì„œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
- [ ] ì‹¤ì‹œê°„ ë™ê¸°í™” ì‘ë™ í™•ì¸
- [ ] ëª¨ë°”ì¼ ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì† í…ŒìŠ¤íŠ¸

---

## ğŸš€ ë°°í¬Â·ìš´ì˜ ê°€ì´ë“œ

### AWS Amplify ë°°í¬

#### 1ë‹¨ê³„: GitHub ì—°ê²°

1. [Amplify Console](https://console.aws.amazon.com/amplify/) ì ‘ì†
2. "New app" â†’ "Host web app" í´ë¦­
3. GitHub/GitLab ì €ì¥ì†Œ ì—°ê²° (OAuth ì¸ì¦)
4. ë¸Œëœì¹˜ ì„ íƒ (main ë˜ëŠ” develop)
5. ì•± ë£¨íŠ¸ ë””ë ‰í† ë¦¬: `aiot-device-manager-fe-working`

#### 2ë‹¨ê³„: ë¹Œë“œ ì„¤ì • (amplify.yml)

```yaml
version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm ci  # npm installë³´ë‹¤ ë¹ ë¦„
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: dist
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
```

#### 3ë‹¨ê³„: í™˜ê²½ ë³€ìˆ˜ ì£¼ì…

Amplify Console â†’ App settings â†’ Environment variables

```
VITE_FIREBASE_API_KEY = <Firebase ê°’>
VITE_FIREBASE_AUTH_DOMAIN = <Firebase ê°’>
VITE_FIREBASE_PROJECT_ID = <Firebase ê°’>
VITE_FIREBASE_STORAGE_BUCKET = <Firebase ê°’>
VITE_FIREBASE_MESSAGING_SENDER_ID = <Firebase ê°’>
VITE_FIREBASE_APP_ID = <Firebase ê°’>
VITE_BACKEND_BASE_URL = <ë°±ì—”ë“œ URL>
```

#### 4ë‹¨ê³„: ë°°í¬ ì™„ë£Œ

- Git Push ì‹œ ìë™ ë¹Œë“œÂ·ë°°í¬
- ë°°í¬ URL: `https://<branch>.<app-id>.amplifyapp.com`
- **ì¤‘ìš”**: Firebase Console â†’ Authentication â†’ ìŠ¹ì¸ëœ ë„ë©”ì¸ì— Amplify URL ì¶”ê°€

---

### ë°±ì—”ë“œ ë°°í¬ (Phase 2)

#### Docker ì»¨í…Œì´ë„ˆí™”

**Dockerfile**:

```dockerfile
FROM node:18-alpine
WORKDIR /app

COPY package*.json ./
RUN npm ci --production

COPY dist ./dist

EXPOSE 4000
CMD ["node", "dist/server.js"]
```

**ë¹Œë“œ ë° ì‹¤í–‰**:

```bash
docker build -t aiot-backend .
docker run -p 4000:4000 --env-file .env aiot-backend
```

#### ë°°í¬ ì˜µì…˜

**Option 1: AWS ECS/Fargate**

- ê´€ë¦¬í˜• ì»¨í…Œì´ë„ˆ ì„œë¹„ìŠ¤
- ìë™ í™•ì¥ ë° ë¡œë“œ ë°¸ëŸ°ì‹±
- ì˜ˆìƒ ë¹„ìš©: $30-50/ì›”

**Option 2: AWS Elastic Beanstalk**

- Node.js í”Œë«í¼ ì¦‰ì‹œ ì‚¬ìš©
- Git ê¸°ë°˜ ë°°í¬
- ì˜ˆìƒ ë¹„ìš©: $20-40/ì›”

**Option 3: Google Cloud Run**

- ì„œë²„ë¦¬ìŠ¤ ì»¨í…Œì´ë„ˆ
- ìš”ì²­ ê¸°ë°˜ ìë™ í™•ì¥
- ì˜ˆìƒ ë¹„ìš©: $10-30/ì›”

**Option 4: ì¼ë°˜ VPS (PM2)**

- AWS EC2, DigitalOcean ë“±
- PM2ë¡œ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬
- ì˜ˆìƒ ë¹„ìš©: $10-20/ì›”

#### í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬

**AWS Systems Manager Parameter Store**:

```bash
aws ssm put-parameter \
  --name /aiot/prod/firebase-key \
  --value "-----BEGIN PRIVATE KEY-----..." \
  --type SecureString
```

**í™˜ê²½ë³„ ì„¤ì •**:

```bash
# .env.development
MYSQL_HOST=localhost

# .env.production
MYSQL_HOST=prod-db.example.com
```

---

### ëª¨ë‹ˆí„°ë§

#### Firebase Console

- **Authentication**: ì‚¬ìš©ì í™œë™ ì¶”ì , ë¡œê·¸ì¸ í†µê³„
- **Firestore**: ì½ê¸°/ì“°ê¸° í†µê³„, ì¸ë±ìŠ¤ ì„±ëŠ¥
- **Usage**: ë¹„ìš© ëª¨ë‹ˆí„°ë§, í• ë‹¹ëŸ‰ ê²½ê³  ì„¤ì •

#### Amplify Console

- **Monitoring**: ë¹Œë“œ íˆìŠ¤í† ë¦¬, ë°°í¬ ìƒíƒœ
- **íŠ¸ë˜í”½ í†µê³„**: ë°©ë¬¸ì ìˆ˜, ëŒ€ì—­í­ ì‚¬ìš©ëŸ‰
- **ì—ëŸ¬ ë¡œê·¸**: ë¹Œë“œ ì‹¤íŒ¨ ì›ì¸ ë¶„ì„

#### ë°±ì—”ë“œ ë¡œê·¸ (Pino)

**ë¡œì»¬ ê°œë°œ**:

```bash
npm run dev
# Pretty-print ë¡œê·¸ ì¶œë ¥
{"level":30,"time":1627890123,"msg":"Server started on port 4000"}
```

**í”„ë¡œë•ì…˜**:

```bash
npm start
# JSON í˜•ì‹ ë¡œê·¸ â†’ CloudWatch/ELK ì—°ë™
```

---

### í™•ì¥ ì‹œë‚˜ë¦¬ì˜¤

#### Phase 3: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤

```
Frontend â†’ API Gateway
            â†“
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”
   â†“        â†“        â†“
Device   Sensor   Analytics
Service  Service  Service
   â†“        â†“        â†“
  DB1      DB2      DB3
```

**ì¶”ê°€ ê°€ëŠ¥ ê¸°ëŠ¥**:

- ë°ì´í„° ë¶„ì„ (Pandas/NumPy)
- ì•Œë¦¼ ì‹œìŠ¤í…œ (FCM/SNS)
- ì™¸ë¶€ API ì—°ë™ (ERP, CRM)
- ë¨¸ì‹ ëŸ¬ë‹ ì˜ˆì¸¡ (TensorFlow)

#### Phase 4: Kubernetes ë°°í¬

- **ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜**: Kubernetes/EKS
- **ì„œë¹„ìŠ¤ ë©”ì‹œ**: Istio, Linkerd
- **CI/CD**: GitHub Actions + ArgoCD
- **ëª¨ë‹ˆí„°ë§**: Prometheus + Grafana

---

## ğŸ”§ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ

### Firebase ê´€ë ¨

#### ë¬¸ì œ: Firestore ë°ì´í„°ê°€ í‘œì‹œë˜ì§€ ì•ŠìŒ

**ì›ì¸ 1**: Security Rules ë¯¸ì„¤ì •

```javascript
// Firebase Console â†’ Firestore â†’ Rulesì—ì„œ í™•ì¸
// í…ŒìŠ¤íŠ¸ ëª¨ë“œë¡œ ë³€ê²½ (ì„ì‹œ)
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /{document=**} {
      allow read, write: if true; // âš ï¸ ê°œë°œ ì¤‘ì—ë§Œ ì‚¬ìš©
    }
  }
}
```

**ì›ì¸ 2**: userId í•„í„°ë§ ì˜¤ë¥˜

```javascript
// âŒ ì˜ëª»ëœ ì½”ë“œ
const q = query(
  collection(db, 'devices'),
  where('userId', '==', auth.currentUser.uid) // currentUserê°€ nullì¼ ìˆ˜ ìˆìŒ
);

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ
const q = query(
  collection(db, 'devices'),
  where('userId', '==', auth.currentUser?.uid) // Optional chaining
);
```

**ì›ì¸ 3**: onSnapshot êµ¬ë… ë¯¸ì„¤ì •

```javascript
// âŒ ì˜ëª»ëœ ì½”ë“œ - êµ¬ë… ì—†ì´ í•œ ë²ˆë§Œ ì¡°íšŒ
const snapshot = await getDocs(q);

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ - ì‹¤ì‹œê°„ êµ¬ë…
const unsubscribe = onSnapshot(q, (snapshot) => {
  // ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ ì²˜ë¦¬
});
```

---

#### ë¬¸ì œ: Google ë¡œê·¸ì¸ íŒì—…ì´ ì°¨ë‹¨ë¨

**ì›ì¸**: íŒì—… ì°¨ë‹¨ ì„¤ì •

```javascript
// âŒ ì˜ëª»ëœ ì½”ë“œ - ë¹„ë™ê¸° í˜¸ì¶œ í›„ íŒì—…
async function login() {
  await someAsyncFunction();
  await signInWithPopup(auth, provider); // íŒì—… ì°¨ë‹¨ë¨
}

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ - ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë‚´ë¶€ì—ì„œ ì¦‰ì‹œ í˜¸ì¶œ
button.addEventListener('click', async () => {
  await signInWithPopup(auth, provider); // âœ… ì •ìƒ ë™ì‘
});
```

---

#### ë¬¸ì œ: "auth/unauthorized-domain" ì—ëŸ¬

**í•´ê²° ë°©ë²•**:

1. Firebase Console â†’ Authentication â†’ Settings
2. Authorized domainsì— ë‹¤ìŒ ì¶”ê°€:
    - `localhost`
    - `*.amplifyapp.com`
    - ì»¤ìŠ¤í…€ ë„ë©”ì¸ (ìˆëŠ” ê²½ìš°)

---

### Amplify ë°°í¬ ê´€ë ¨

#### ë¬¸ì œ: ë¹Œë“œ ì‹¤íŒ¨ "Module not found"

**ì›ì¸**: package.jsonê³¼ ì‹¤ì œ ì„¤ì¹˜ëœ íŒ¨í‚¤ì§€ ë¶ˆì¼ì¹˜

**í•´ê²°**:

```yaml
# amplify.yml ìˆ˜ì •
preBuild:
  commands:
    - npm ci  # âœ… npm install ëŒ€ì‹  ci ì‚¬ìš©
```

**ì¶”ê°€ í™•ì¸**:

```bash
# ë¡œì»¬ì—ì„œ ë¹Œë“œ í…ŒìŠ¤íŠ¸
rm -rf node_modules package-lock.json
npm install
npm run build
```

---

#### ë¬¸ì œ: í™˜ê²½ ë³€ìˆ˜ê°€ ì ìš©ë˜ì§€ ì•ŠìŒ

**ì›ì¸**: Vite í™˜ê²½ ë³€ìˆ˜ëŠ” `VITE_` ì ‘ë‘ì‚¬ í•„ìš”

**í•´ê²°**:

```bash
# âŒ ì˜ëª»ëœ ì„¤ì •
FIREBASE_API_KEY=xxx

# âœ… ì˜¬ë°”ë¥¸ ì„¤ì •
VITE_FIREBASE_API_KEY=xxx
```

**í™•ì¸ ë°©ë²•**:

```javascript
// ì½”ë“œì—ì„œ í™•ì¸
console.log(import.meta.env.VITE_FIREBASE_API_KEY);
```

---

#### ë¬¸ì œ: ë°°í¬ í›„ 404 ì—ëŸ¬ (ë¦¬í”„ë ˆì‹œ ì‹œ)

**ì›ì¸**: SPA ë¼ìš°íŒ… ì„¤ì • ëˆ„ë½

**í•´ê²°**: Amplify Console â†’ Rewrites and redirects ì¶”ê°€

```
Source address: </^[^.]+$|\.(?!(css|gif|ico|jpg|js|png|txt|svg|woff|ttf|map|json)$)([^.]+$)/>
Target address: /index.html
Type: 200 (Rewrite)
```

---

### MySQL ì—°ê²° ì˜¤ë¥˜ (Phase 2)

#### ë¬¸ì œ: "ER_ACCESS_DENIED_ERROR"

**ì›ì¸**: MySQL ì‚¬ìš©ì ê¶Œí•œ ë¬¸ì œ

**í•´ê²°**:

```bash
# Docker ì»¨í…Œì´ë„ˆ ì¬ìƒì„±
docker compose down -v
docker compose up -d

# ìŠ¤í‚¤ë§ˆ ì¬ì ìš©
npm run db:migrate
```

**ìˆ˜ë™ í™•ì¸**:

```bash
# MySQL ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it mysql-container mysql -u root -p

# ì‚¬ìš©ì ê¶Œí•œ í™•ì¸
SHOW GRANTS FOR 'appuser'@'%';

# ê¶Œí•œ ë¶€ì—¬
GRANT ALL PRIVILEGES ON aiot_device_manager.* TO 'appuser'@'%';
FLUSH PRIVILEGES;
```

---

#### ë¬¸ì œ: "Too many connections"

**ì›ì¸**: ì»¤ë„¥ì…˜ í’€ ì„¤ì • ë¶€ì¡±

**í•´ê²°**:

```typescript
// db/pool.ts ìˆ˜ì •
const pool = mysql.createPool({
  host: process.env.MYSQL_HOST,
  user: process.env.MYSQL_USER,
  password: process.env.MYSQL_PASSWORD,
  database: process.env.MYSQL_DATABASE,
  connectionLimit: 10, // âœ… ì œí•œ ì„¤ì •
  queueLimit: 0
});
```

---

### MQTT ì—°ê²° ë¬¸ì œ

#### ë¬¸ì œ: "WebSocket connection failed"

**ì›ì¸ 1**: ë¸Œë¡œì»¤ URL ì˜¤ë¥˜

```javascript
// âŒ ì˜ëª»ëœ URL
url: "mqtt://broker.hivemq.com:1883" // WebSocket ì•„ë‹˜

// âœ… ì˜¬ë°”ë¥¸ URL
url: "ws://broker.hivemq.com:8000/mqtt" // WebSocket ì‚¬ìš©
```

**ì›ì¸ 2**: CORS ì •ì±…

- ì¼ë¶€ ê³µê°œ ë¸Œë¡œì»¤ëŠ” íŠ¹ì • ë„ë©”ì¸ë§Œ í—ˆìš©
- ë¡œì»¬ Mosquitto ë¸Œë¡œì»¤ ì‚¬ìš© ê¶Œì¥

---

### ì„±ëŠ¥ ë¬¸ì œ

#### ë¬¸ì œ: Firestore ì½ê¸° ë¹„ìš© ê¸‰ì¦

**ì›ì¸**: ë¶ˆí•„ìš”í•œ onSnapshot êµ¬ë…

**í•´ê²°**:

```javascript
// âŒ ì˜ëª»ëœ ì½”ë“œ - ì»´í¬ë„ŒíŠ¸ë§ˆë‹¤ êµ¬ë…
useEffect(() => {
  const unsubscribe = onSnapshot(q, callback);
  return () => unsubscribe();
}, []); // ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì¤‘ë³µ êµ¬ë…

// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ - ì „ì—­ ìƒíƒœë¡œ í•œ ë²ˆë§Œ êµ¬ë…
const appManager = new AppManager();
appManager.subscribeToDevices(); // ë‹¨ í•œ ë²ˆë§Œ êµ¬ë…
```

---

#### ë¬¸ì œ: Amplify ë¹Œë“œ ì‹œê°„ì´ ë„ˆë¬´ ê¹€

**í•´ê²°**:

```yaml
# amplify.ymlì— ìºì‹œ ì¶”ê°€
cache:
  paths:
    - node_modules/**/*
    - .vite/**/*  # Vite ìºì‹œ
```

---

## ğŸ’° ë¹„ìš© ê³„ì‚°ê¸°

### Phase 1: Firebase + Amplify

#### ë¬´ë£Œ í• ë‹¹ëŸ‰

|í•­ëª©|ë¬´ë£Œ ë²”ìœ„|ì´ˆê³¼ ì‹œ ê³¼ê¸ˆ|
|---|---|---|
|**Firebase Auth**|ë¬´ì œí•œ|ë¬´ë£Œ (ê³„ì†)|
|**Firestore ì½ê¸°**|50,000/ì¼|$0.06 / 100,000ê±´|
|**Firestore ì“°ê¸°**|20,000/ì¼|$0.18 / 100,000ê±´|
|**Firestore ì‚­ì œ**|20,000/ì¼|$0.02 / 100,000ê±´|
|**Firestore ì €ì¥**|1GB|$0.18 / GB/ì›”|
|**Amplify ë¹Œë“œ**|1,000ë¶„/ì›”|$0.01 / ë¶„|
|**Amplify í˜¸ìŠ¤íŒ…**|15GB/ì›”|$0.15 / GB|
|**CloudFront ì „ì†¡**|1TB/ì›”|$0.085 / GB|

#### ì˜ˆìƒ ë¹„ìš© (ì‚¬ìš©ì ìˆ˜ë³„)

**100 ì‚¬ìš©ì (ê°€ë²¼ìš´ ì‚¬ìš©)**:

- Firestore ì½ê¸°: 10,000/ì¼ â†’ ë¬´ë£Œ
- Firestore ì“°ê¸°: 2,000/ì¼ â†’ ë¬´ë£Œ
- Amplify í˜¸ìŠ¤íŒ…: 5GB/ì›” â†’ ë¬´ë£Œ
- **ì´ ë¹„ìš©**: **$0/ì›”**

**1,000 ì‚¬ìš©ì (ì¤‘ê°„ ì‚¬ìš©)**:

- Firestore ì½ê¸°: 100,000/ì¼ â†’ $3/ì›”
- Firestore ì“°ê¸°: 30,000/ì¼ â†’ $1.5/ì›”
- Firestore ì €ì¥: 3GB â†’ $0.5/ì›”
- Amplify ë¹Œë“œ: 50ë¶„/ì›” â†’ ë¬´ë£Œ
- Amplify í˜¸ìŠ¤íŒ…: 30GB/ì›” â†’ $2.25/ì›”
- CloudFront: 100GB/ì›” â†’ $8.5/ì›”
- **ì´ ë¹„ìš©**: **$15.75/ì›”**

**10,000 ì‚¬ìš©ì (í™œë°œí•œ ì‚¬ìš©)**:

- Firestore ì½ê¸°: 1,000,000/ì¼ â†’ $30/ì›”
- Firestore ì“°ê¸°: 300,000/ì¼ â†’ $15/ì›”
- Firestore ì €ì¥: 10GB â†’ $1.8/ì›”
- Amplify í˜¸ìŠ¤íŒ…: 100GB/ì›” â†’ $12.75/ì›”
- CloudFront: 500GB/ì›” â†’ $42.5/ì›”
- **ì´ ë¹„ìš©**: **$102.05/ì›”**

---

### Phase 2: ë°±ì—”ë“œ ì¶”ê°€ ì‹œ

#### ì¶”ê°€ ì¸í”„ë¼ ë¹„ìš©

|í•­ëª©|ì‚¬ì–‘|ì˜ˆìƒ ë¹„ìš© (ì›”)|
|---|---|---|
|**EC2**|t3.small (2 vCPU, 2GB RAM)|$15|
|**RDS MySQL**|t3.micro (2 vCPU, 1GB RAM)|$25|
|**Application Load Balancer**|-|$20|
|**NAT Gateway** (ì„ íƒ)|-|$45|
|**CloudWatch Logs**|5GB/ì›”|$2.5|
|**ì´ ì¶”ê°€ ë¹„ìš©**|-|**$62.5 ~ $107.5/ì›”**|

#### ì „ì²´ ë¹„ìš© ì˜ˆìƒ (Phase 2)

**1,000 ì‚¬ìš©ì**:

- Phase 1: $15.75/ì›”
- Phase 2 ì¶”ê°€: $62.5/ì›”
- **ì´ ë¹„ìš©**: **$78.25/ì›”**

**10,000 ì‚¬ìš©ì**:

- Phase 1: $102.05/ì›”
- Phase 2 ì¶”ê°€ (EC2 í™•ì¥): $100/ì›”
- **ì´ ë¹„ìš©**: **$202.05/ì›”**

---

### ğŸ’¡ ë¹„ìš© ì ˆê° íŒ

#### Firestore ìµœì í™”

```javascript
// âŒ ë¹„íš¨ìœ¨ì  - ë§¤ë²ˆ ì „ì²´ ì¡°íšŒ
const snapshot = await getDocs(collection(db, 'devices'));

// âœ… íš¨ìœ¨ì  - í•„í„°ë§ + ì œí•œ
const q = query(
  collection(db, 'devices'),
  where('userId', '==', uid),
  limit(10)
);
```

#### CloudFront ìºì‹±

```javascript
// Amplify Console â†’ Hosting â†’ Custom Headers
{
  "Cache-Control": "max-age=31536000" // ì •ì  ìì‚° 1ë…„ ìºì‹±
}
```

#### RDS Reserved Instance

- 1ë…„ ì˜ˆì•½: 30% í• ì¸
- 3ë…„ ì˜ˆì•½: 50% í• ì¸

#### Spot Instances (ê°œë°œ í™˜ê²½)

- ìµœëŒ€ 90% í• ì¸
- ì¤‘ë‹¨ ê°€ëŠ¥í•œ ì›Œí¬ë¡œë“œì—ë§Œ ì‚¬ìš©

---

## ğŸ¯ í•™ìŠµ ëª©í‘œ ë‹¬ì„± ì²´í¬

### ì´ ê³¼ì •ì„ í†µí•´ ë°°ìš´ ê²ƒë“¤

#### âœ… ê¸°ìˆ ì  ì—­ëŸ‰

- [ ] Firebase Auth + Firestore í†µí•© í™œìš©
- [ ] ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™” êµ¬í˜„
- [ ] AWS Amplify ìë™ ë°°í¬ ì„¤ì •
- [ ] Express + TypeScript ë°±ì—”ë“œ êµ¬ì¶•
- [ ] MySQL ìŠ¤í‚¤ë§ˆ ì„¤ê³„ ë° ì¿¼ë¦¬ ì‘ì„±
- [ ] Dockerë¥¼ í™œìš©í•œ ë¡œì»¬ ê°œë°œ í™˜ê²½ êµ¬ì„±

#### âœ… ì•„í‚¤í…ì²˜ ì„¤ê³„ ëŠ¥ë ¥

- [ ] Serverless vs Backend ì„ íƒ ê¸°ì¤€ ì´í•´
- [ ] í•˜ì´ë¸Œë¦¬ë“œ ë°ì´í„° ì „ëµ ìˆ˜ë¦½
- [ ] ë‹¨ê³„ë³„ í™•ì¥ ê³„íš ìˆ˜ë¦½
- [ ] ë³´ì•ˆ ì„¤ê³„ (ì¸ì¦, ì¸ê°€, ë°ì´í„° ê²©ë¦¬)

#### âœ… ì‹¤ë¬´ ì ìš© ëŠ¥ë ¥

- [ ] MVP ë¹ ë¥¸ ì¶œì‹œ ì „ëµ
- [ ] ë¹„ìš© íš¨ìœ¨ì ì¸ ê¸°ìˆ  ì„ íƒ
- [ ] ëª¨ë‹ˆí„°ë§ ë° íŠ¸ëŸ¬ë¸”ìŠˆíŒ…
- [ ] ë¬¸ì„œí™” ë° ì§€ì‹ ê³µìœ 

---

## ğŸ”‘ í•µì‹¬ í‚¤ì›Œë“œ

### Firebase ì‹¬í™” í•™ìŠµ

- `Firebase Security Rules` â†’ ê³ ê¸‰ ì ‘ê·¼ ì œì–´, í•¨ìˆ˜ ê¸°ë°˜ ê·œì¹™
- `Firestore Indexes` â†’ ë³µí•© ì¿¼ë¦¬ ìµœì í™”
- `Firebase Extensions` â†’ ì„œë²„ë¦¬ìŠ¤ í•¨ìˆ˜ (Resize Images, Send Emails)
- `Firebase Cloud Functions` â†’ ë°±ì—”ë“œ ë¡œì§ ì¶”ê°€

### ì‹¤ì‹œê°„ í†µì‹ 

- `MQTT over WebSocket` â†’ QoS ë ˆë²¨, Retain ë©”ì‹œì§€
- `MQTT Topics` â†’ ì™€ì¼ë“œì¹´ë“œ êµ¬ë…, ê³„ì¸µ êµ¬ì¡°
- `Firebase Realtime Database` â†’ Firestore vs RTDB ë¹„êµ

### í”„ë¡ íŠ¸ì—”ë“œ ìµœì í™”

- `Vite Plugin Ecosystem` â†’ PWA, ì´ë¯¸ì§€ ìµœì í™”
- `Code Splitting` â†’ ë™ì  import, ë²ˆë“¤ ë¶„í• 
- `Service Worker` â†’ ì˜¤í”„ë¼ì¸ ìºì‹±, ë°±ê·¸ë¼ìš´ë“œ ë™ê¸°í™”

### AWS ì¸í”„ë¼

- `CloudFront Cache Invalidation` â†’ CDN ìºì‹œ ê´€ë¦¬
- `Amplify Environment` â†’ ë¸Œëœì¹˜ë³„ ë°°í¬, Preview í™˜ê²½
- `AWS WAF` â†’ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°©í™”ë²½

### ë°±ì—”ë“œ ì„¤ê³„

- `JWT Token Verification` â†’ Firebase Admin SDK
- `Database Indexing` â†’ MySQL ì¸ë±ìŠ¤ ì „ëµ
- `API Rate Limiting` â†’ express-rate-limit
- `Database Connection Pooling` â†’ ì»¤ë„¥ì…˜ ìµœì í™”

### ìš´ì˜ ê´€ì 

- ì‚¬ìš©ëŸ‰ ê¸°ë°˜ ê³¼ê¸ˆ ëª¨ë‹ˆí„°ë§
- Firestore ì½ê¸°/ì“°ê¸° ìµœì í™” (onSnapshot íš¨ìœ¨í™”)
- Firebase ID í† í° ìºì‹± ì „ëµ
- MySQL Slow Query ë¶„ì„
- ë¡œê·¸ ì§‘ê³„ ë° ì•Œë¦¼ (CloudWatch, Sentry)

---

## ğŸš€ í™•ì¥ í•™ìŠµ ê²½ë¡œ

### 1ë‹¨ê³„: Firebase ë§ˆìŠ¤í„° (í˜„ì¬ ê³¼ì •)

- Firebase Auth + Firestore ì™„ì „ ì´í•´
- Security Rules ê³ ê¸‰ í™œìš©
- ì‹¤ì‹œê°„ ë™ê¸°í™” ìµœì í™”

### 2ë‹¨ê³„: ë°±ì—”ë“œ ì¶”ê°€ (Phase 2)

- Express + TypeScript
- MySQL ë°ì´í„° ëª¨ë¸ë§
- Firebase Admin SDK
- Docker ì»¨í…Œì´ë„ˆí™”

### 3ë‹¨ê³„: ì„±ëŠ¥ ë° í™•ì¥ì„±

- Redis ìºì‹± ì¶”ê°€
- Load Balancer êµ¬ì„±
- CDN ìµœì í™”
- Database ì½ê¸° ë³µì œë³¸

### 4ë‹¨ê³„: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤

- ì„œë¹„ìŠ¤ ë¶„ë¦¬ (Device, Sensor, Analytics)
- API Gateway íŒ¨í„´
- ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ (Kafka, RabbitMQ)
- ì„œë¹„ìŠ¤ ë©”ì‹œ (Istio)

### 5ë‹¨ê³„: Kubernetes ë°°í¬

- EKS/GKE í´ëŸ¬ìŠ¤í„° êµ¬ì„±
- Helm Charts
- Horizontal Pod Autoscaling
- Prometheus + Grafana ëª¨ë‹ˆí„°ë§

---

## ğŸ“š ì°¸ê³  ìë£Œ

### ê³µì‹ ë¬¸ì„œ

- [Firebase Documentation](https://firebase.google.com/docs)
- [AWS Amplify Guide](https://docs.amplify.aws/)
- [Vite Guide](https://vitejs.dev/guide/)
- [Express.js](https://expressjs.com/)
- [MQTT Protocol](https://mqtt.org/)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)

### ë³´ì•ˆ ê°€ì´ë“œ

- [Firebase Security Rules](https://firebase.google.com/docs/rules)
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [OWASP API Security](https://owasp.org/www-project-api-security/)

### ì•„í‚¤í…ì²˜ íŒ¨í„´

- [The Twelve-Factor App](https://12factor.net/)
- [Cloud Design Patterns](https://learn.microsoft.com/en-us/azure/architecture/patterns/)
- [Microservices Patterns](https://microservices.io/patterns/)

### ì„±ëŠ¥ ìµœì í™”

- [Web Vitals](https://web.dev/vitals/)
- [Lighthouse](https://developers.google.com/web/tools/lighthouse)
- [MySQL Performance Tuning](https://dev.mysql.com/doc/refman/8.0/en/optimization.html)

---

## ğŸ‰ ë§ˆë¬´ë¦¬

ì´ ë¬¸ì„œëŠ” **"ëª¨ë˜í´ë¼ìš°ë“œ ê¸°ë°˜ ì„œë¹„ìŠ¤ í”Œë«í¼ ì„¤ê³„, êµ¬ì¶• ë° ë°°í¬"** êµìœ¡ê³¼ì •ì˜ í•µì‹¬ ì•„í‚¤í…ì²˜ ê°€ì´ë“œì…ë‹ˆë‹¤.

### í•µì‹¬ ë©”ì‹œì§€

1. **ë¹ ë¥¸ ì‹œì‘**: Firebaseë¡œ ì„œë²„ ì—†ì´ MVP ì™„ì„±
2. **ì ì§„ì  í™•ì¥**: í•„ìš”í•  ë•Œ ë°±ì—”ë“œ ì¶”ê°€
3. **ì‹¤ë¬´ ì¤‘ì‹¬**: ì‹¤ì œ í”„ë¡œë•ì…˜ ë°°í¬ê¹Œì§€ ê²½í—˜
4. **ë¹„ìš© íš¨ìœ¨**: ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ë¡œ ì¸í”„ë¼ ë¶€ë‹´ ìµœì†Œí™”

### ë‹¤ìŒ ë‹¨ê³„

- ì‹¤ìŠµ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ë”°ë¼ ì§ì ‘ êµ¬í˜„
- íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ ì°¸ê³ í•˜ì—¬ ë¬¸ì œ í•´ê²°
- í™•ì¥ í•™ìŠµ ê²½ë¡œë¥¼ ë”°ë¼ ì§€ì†ì  ì„±ì¥

**êµìœ¡ ë¬¸ì˜**: flitsky@naver.com

---

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-01-03  
**ë²„ì „**: 2.0 (í†µí•© ìµœì í™” ë²„ì „)